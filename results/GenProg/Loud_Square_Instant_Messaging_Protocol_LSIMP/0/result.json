{
  "repair_begin": "2020-10-12 11:43:37.238596",
  "repair_end": "2020-10-12 11:44:47.536071",
  "patches": [
    {
      "target_file": "src/lsimp.i",
      "fix": "240a241\n>   {\n241a243,244\n>   pos ++;\n>   }\n",
      "edits": [
        "239a240\n>   {\n240a242,250\n>   if (msg->__annonCompField1.keyx.key_len > 128U) {\n>     goto fail__0;\n>   } else\n>   if (buf_len < msg->__annonCompField1.keyx.key_len) {\n>     goto fail__0;\n>   } else {\n> \n>   }\n>   }\n",
        "240a241\n>   {\n241a243,244\n>   pos ++;\n>   }\n",
        "260,267c260\n<     if ((unsigned long )buf_len >= sizeof(char )) {\n<       tmp___0 = pos;\n<       pos ++;\n<       msg->__annonCompField1.helo.version = *tmp___0;\n<       buf_len --;\n<     } else {\n< \n<     }\n---\n>     buf_len --;\n272c265,272\n<       buf_len --;\n---\n>       if ((unsigned long )buf_len >= sizeof(char )) {\n>         tmp___0 = pos;\n>         pos ++;\n>         msg->__annonCompField1.helo.version = *tmp___0;\n>         buf_len --;\n>       } else {\n> \n>       }\n"
      ]
    }
  ],
  "error": "cat: /etc/redhat-release: No such file or directory\nBug: BF(Liveness): stmtStartData is not initialized for 163: fail__0: \n#line 191\nif (msg) {\n#line 192 \"/tmp/GenProg_Loud_Square_Instant_Messaging_Protocol_LSIMP_0/Loud_Square_Instant_Messaging_Protocol_LSIMP/src/lsimp.c\"\n  cgc_free((void *)msg);\n} else {\n\n}\nLiveness failed on function:\n lsimp_msg_t *cgc_parse_msg(char *buf , unsigned int buf_len ) \n{ \n  int dword ;\n  unsigned int obl ;\n  char *pos ;\n  lsimp_msg_t *msg ;\n  void *tmp ;\n  char *tmp___0 ;\n  char *tmp___1 ;\n  char *tmp___2 ;\n  void *tmp___3 ;\n  void *tmp___4 ;\n  void *tmp___5 ;\n  int guard ;\n  int tmp___6 ;\n\n  {\n   29: /* CIL Label */ \n#line 60\n  obl = buf_len;\n   30: /* CIL Label */ \n#line 61\n  pos = buf;\n   31: /* CIL Label */ \n#line 62\n  msg = (lsimp_msg_t *)0;\n   32: /* CIL Label */ \n#line 64\n  if (buf_len < 4U) {\n     -33: /* CIL Label */ \n#line 65\n    goto  163;\n  } else {\n     34: /* CIL Label */ ;\n  }\n   0: /* CIL Label */ \n  {\n   35: /* CIL Label */ \n#line 67\n  tmp = cgc_malloc(sizeof(lsimp_msg_t ));\n   0: /* CIL Label */ \n#line 115\n  if (msg->__annonCompField1.keyx.key_len > 128U) {\n     0: /* CIL Label */ \n#line 116\n    goto fail__0;\n  } else\n   0: /* CIL Label */ \n#line 115\n  if (buf_len < msg->__annonCompField1.keyx.key_len) {\n     0: /* CIL Label */ \n#line 116\n    goto fail__0;\n  } else {\n     0: /* CIL Label */ ;\n  }\n  }\n   36: /* CIL Label */ \n#line 67\n  msg = (lsimp_msg_t *)tmp;\n   37: /* CIL Label */ \n#line 68\n  if ((unsigned long )msg == (unsigned long )((lsimp_msg_t *)0)) {\n     -38: /* CIL Label */ \n#line 69\n    goto  163;\n  } else {\n     39: /* CIL Label */ ;\n  }\n   40: /* CIL Label */ \n#line 70\n  cgc_memset((void *)msg, 0, sizeof(lsimp_msg_t ));\n   41: /* CIL Label */ \n#line 72\n  while (1) {\n     42: /* CIL Label */ \n#line 72\n    if (buf_len >= 4U) {\n       43: /* CIL Label */ ;\n    } else {\n       -44: /* CIL Label */ \n#line 72\n      break;\n    }\n     45: /* CIL Label */ \n#line 77\n    if (buf_len == 4U) {\n       -46: /* CIL Label */ \n#line 77\n      break;\n    } else {\n       47: /* CIL Label */ ;\n    }\n     48: /* CIL Label */ \n#line 78\n    dword = *((int *)pos);\n     49: /* CIL Label */ \n#line 79\n    pos += sizeof(int );\n     50: /* CIL Label */ \n#line 80\n    buf_len = (unsigned int )((unsigned long )buf_len - sizeof(int ));\n     -51: /* CIL Label */ \n#line 81\n    switch (dword) {\n     52: /* CIL Label */ \n    case 1330398536: \n#line 84\n    msg->type = (enum lsimp_msg_type_t )1330398536;\n     53: /* CIL Label */ \n#line 85\n    if ((unsigned long )buf_len >= sizeof(char )) {\n       54: /* CIL Label */ \n#line 87\n      tmp___0 = pos;\n       55: /* CIL Label */ \n#line 87\n      pos ++;\n       56: /* CIL Label */ \n#line 87\n      msg->__annonCompField1.helo.version = *tmp___0;\n       57: /* CIL Label */ \n#line 88\n      buf_len --;\n    } else {\n       58: /* CIL Label */ ;\n    }\n     59: /* CIL Label */ \n#line 90\n    if ((unsigned long )buf_len >= sizeof(char )) {\n       60: /* CIL Label */ \n#line 92\n      tmp___1 = pos;\n       61: /* CIL Label */ \n#line 92\n      pos ++;\n       62: /* CIL Label */ \n#line 92\n      msg->__annonCompField1.helo.secure_mode = *tmp___1;\n       63: /* CIL Label */ \n#line 93\n      buf_len --;\n    } else {\n       64: /* CIL Label */ ;\n    }\n     65: /* CIL Label */ \n#line 95\n    if ((unsigned long )buf_len >= sizeof(int )) {\n       66: /* CIL Label */ \n#line 97\n      msg->__annonCompField1.helo.ttl = *((int *)pos);\n       67: /* CIL Label */ \n#line 98\n      pos += sizeof(int );\n       68: /* CIL Label */ \n#line 99\n      buf_len = (unsigned int )((unsigned long )buf_len - sizeof(int ));\n    } else {\n       69: /* CIL Label */ ;\n    }\n     -70: /* CIL Label */ \n#line 101\n    break;\n     71: /* CIL Label */ \n    case 1482245451: \n#line 103\n    msg->type = (enum lsimp_msg_type_t )1482245451;\n     72: /* CIL Label */ \n#line 104\n    if ((unsigned long )buf_len >= sizeof(char )) {\n       73: /* CIL Label */ \n#line 106\n      tmp___2 = pos;\n       74: /* CIL Label */ \n#line 106\n      pos ++;\n       75: /* CIL Label */ \n#line 106\n      msg->__annonCompField1.keyx.option = *tmp___2;\n       76: /* CIL Label */ \n#line 107\n      buf_len --;\n    } else {\n       77: /* CIL Label */ ;\n    }\n     78: /* CIL Label */ \n#line 109\n    if ((unsigned long )buf_len >= sizeof(int )) {\n       79: /* CIL Label */ \n#line 111\n      msg->__annonCompField1.keyx.key_len = (unsigned int )*((int *)pos);\n       80: /* CIL Label */ \n#line 112\n      pos += sizeof(int );\n       81: /* CIL Label */ \n#line 113\n      buf_len = (unsigned int )((unsigned long )buf_len - sizeof(int ));\n    } else {\n       82: /* CIL Label */ ;\n    }\n     83: /* CIL Label */ \n#line 115\n    if (msg->__annonCompField1.keyx.key_len > 128U) {\n       -84: /* CIL Label */ \n#line 116\n      goto  163;\n    } else\n     85: /* CIL Label */ \n#line 115\n    if (buf_len < msg->__annonCompField1.keyx.key_len) {\n       -86: /* CIL Label */ \n#line 116\n      goto  163;\n    } else {\n       87: /* CIL Label */ ;\n    }\n     88: /* CIL Label */ \n#line 117\n    if (msg->__annonCompField1.keyx.key_len > 0U) {\n       89: /* CIL Label */ \n#line 119\n      tmp___3 = cgc_malloc((cgc_size_t )msg->__annonCompField1.keyx.key_len);\n       90: /* CIL Label */ \n#line 119\n      msg->__annonCompField1.keyx.key = (char *)tmp___3;\n       91: /* CIL Label */ \n#line 120\n      if ((unsigned long )msg->__annonCompField1.keyx.key == (unsigned long )((char *)0)) {\n         -92: /* CIL Label */ \n#line 121\n        goto  163;\n      } else {\n         93: /* CIL Label */ ;\n      }\n       94: /* CIL Label */ \n#line 122\n      cgc_memmove((void *)msg->__annonCompField1.keyx.key, (void const   *)pos,\n                  (cgc_size_t )msg->__annonCompField1.keyx.key_len);\n       95: /* CIL Label */ \n#line 123\n      pos += msg->__annonCompField1.keyx.key_len;\n       96: /* CIL Label */ \n#line 124\n      buf_len -= msg->__annonCompField1.keyx.key_len;\n    } else {\n       97: /* CIL Label */ ;\n    }\n     -98: /* CIL Label */ \n#line 126\n    break;\n     99: /* CIL Label */ \n    case 1096040772: \n#line 128\n    msg->type = (enum lsimp_msg_type_t )1096040772;\n     100: /* CIL Label */ \n#line 129\n    if ((unsigned long )buf_len >= sizeof(int )) {\n       101: /* CIL Label */ \n#line 131\n      msg->__annonCompField1.data.seq = *((int *)pos);\n       102: /* CIL Label */ \n#line 132\n      pos += sizeof(int );\n       103: /* CIL Label */ \n#line 133\n      buf_len = (unsigned int )((unsigned long )buf_len - sizeof(int ));\n    } else {\n       104: /* CIL Label */ ;\n    }\n     105: /* CIL Label */ \n#line 135\n    if (msg->__annonCompField1.data.seq < 1) {\n       -106: /* CIL Label */ \n#line 136\n      goto  163;\n    } else {\n       107: /* CIL Label */ ;\n    }\n     108: /* CIL Label */ \n#line 137\n    if ((unsigned long )buf_len >= sizeof(int )) {\n       109: /* CIL Label */ \n#line 139\n      msg->__annonCompField1.data.data_len = (unsigned int )*((int *)pos);\n       110: /* CIL Label */ \n#line 140\n      pos += sizeof(int );\n       111: /* CIL Label */ \n#line 141\n      buf_len = (unsigned int )((unsigned long )buf_len - sizeof(int ));\n    } else {\n       112: /* CIL Label */ ;\n    }\n     113: /* CIL Label */ \n#line 143\n    if (msg->__annonCompField1.data.data_len > 512U) {\n       114: /* CIL Label */ \n#line 143\n      if (buf_len < msg->__annonCompField1.data.data_len) {\n         -115: /* CIL Label */ \n#line 144\n        goto  163;\n      } else {\n         116: /* CIL Label */ ;\n      }\n    } else {\n       117: /* CIL Label */ ;\n    }\n     118: /* CIL Label */ \n#line 145\n    if (msg->__annonCompField1.data.data_len > 0U) {\n       119: /* CIL Label */ \n#line 147\n      tmp___4 = cgc_malloc((cgc_size_t )(msg->__annonCompField1.data.data_len + 1U));\n       120: /* CIL Label */ \n#line 147\n      msg->__annonCompField1.data.data = (char *)tmp___4;\n       121: /* CIL Label */ \n#line 148\n      if ((unsigned long )msg->__annonCompField1.data.data == (unsigned long )((char *)0)) {\n         -122: /* CIL Label */ \n#line 149\n        goto  163;\n      } else {\n         123: /* CIL Label */ ;\n      }\n       124: /* CIL Label */ \n#line 150\n      cgc_memset((void *)msg->__annonCompField1.data.data, 0,\n                 (cgc_size_t )(msg->__annonCompField1.data.data_len + 1U));\n       125: /* CIL Label */ \n#line 151\n      cgc_memmove((void *)msg->__annonCompField1.data.data, (void const   *)pos,\n                  (cgc_size_t )msg->__annonCompField1.data.data_len);\n       126: /* CIL Label */ \n#line 152\n      pos += msg->__annonCompField1.data.data_len;\n       127: /* CIL Label */ \n#line 153\n      buf_len -= msg->__annonCompField1.data.data_len;\n    } else {\n       128: /* CIL Label */ ;\n    }\n     -129: /* CIL Label */ \n#line 155\n    break;\n     130: /* CIL Label */ \n    case 1415071060: \n#line 157\n    msg->type = (enum lsimp_msg_type_t )1415071060;\n     131: /* CIL Label */ \n#line 158\n    if ((unsigned long )buf_len >= sizeof(int )) {\n       132: /* CIL Label */ \n#line 160\n      msg->__annonCompField1.text.msg_len = (unsigned int )*((int *)pos);\n       133: /* CIL Label */ \n#line 161\n      pos += sizeof(int );\n       134: /* CIL Label */ \n#line 162\n      buf_len = (unsigned int )((unsigned long )buf_len - sizeof(int ));\n    } else {\n       135: /* CIL Label */ ;\n    }\n     136: /* CIL Label */ \n#line 164\n    if (msg->__annonCompField1.text.msg_len > 1024U) {\n       137: /* CIL Label */ \n#line 164\n      if (buf_len < msg->__annonCompField1.text.msg_len) {\n         -138: /* CIL Label */ \n#line 165\n        goto  163;\n      } else {\n         139: /* CIL Label */ ;\n      }\n    } else {\n       140: /* CIL Label */ ;\n    }\n     141: /* CIL Label */ \n#line 166\n    if (msg->__annonCompField1.text.msg_len > 0U) {\n       142: /* CIL Label */ \n#line 168\n      tmp___5 = cgc_malloc((cgc_size_t )(msg->__annonCompField1.text.msg_len + 1U));\n       143: /* CIL Label */ \n#line 168\n      msg->__annonCompField1.text.msg = (char *)tmp___5;\n       144: /* CIL Label */ \n#line 169\n      if ((unsigned long )msg->__annonCompField1.text.msg == (unsigned long )((char *)0)) {\n         -145: /* CIL Label */ \n#line 170\n        goto  163;\n      } else {\n         146: /* CIL Label */ ;\n      }\n       147: /* CIL Label */ \n#line 171\n      cgc_memset((void *)msg->__annonCompField1.text.msg, 0,\n                 (cgc_size_t )(msg->__annonCompField1.text.msg_len + 1U));\n       148: /* CIL Label */ \n#line 172\n      cgc_memmove((void *)msg->__annonCompField1.text.msg, (void const   *)pos,\n                  (cgc_size_t )msg->__annonCompField1.text.msg_len);\n       149: /* CIL Label */ \n#line 173\n      pos += msg->__annonCompField1.text.msg_len;\n       150: /* CIL Label */ \n#line 174\n      buf_len -= msg->__annonCompField1.text.msg_len;\n    } else {\n       151: /* CIL Label */ ;\n    }\n     -152: /* CIL Label */ \n#line 176\n    break;\n     -153: /* CIL Label */ \n    default: \n#line 178\n    break;\n    }\n  }\n   154: /* CIL Label */ \n#line 182\n  if (buf_len < 4U) {\n     -155: /* CIL Label */ \n#line 183\n    goto  163;\n  } else {\n     156: /* CIL Label */ ;\n  }\n   157: /* CIL Label */ \n#line 184\n  guard = *((int *)pos);\n   158: /* CIL Label */ \n#line 185\n  tmp___6 = cgc_compute_guard((unsigned char *)buf,\n                              (unsigned int )((unsigned long )obl - sizeof(int )));\n   159: /* CIL Label */ \n#line 185\n  if (guard != tmp___6) {\n     -160: /* CIL Label */ \n#line 186\n    goto  163;\n  } else {\n     161: /* CIL Label */ ;\n  }\n   162: /* CIL Label */ \n#line 188\n  return (msg);\n   163: /* CIL Label */ \n  fail: \n#line 191\n  if (msg) {\n     164: /* CIL Label */ \n#line 192\n    cgc_free((void *)msg);\n  } else {\n     165: /* CIL Label */ ;\n  }\n   166: /* CIL Label */ \n#line 193\n  return ((lsimp_msg_t *)0);\n}\n}\n\n"
}